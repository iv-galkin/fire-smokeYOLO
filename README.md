# Детекция огня и дыма с использованием YOLOv8m

---

## Цель исследования
Научиться определять и выделять на изображении огонь и дым. 
Для этого изучить свежие статьи на тему детекции огня и дыма на изображениях, сделать обзор статей. 
Обучить модель детекции огня и дыма.

---

## Проблема обнаружения пожаров
Традиционные методы обнаружения пожаров (аспирационные детекторы, ручной мониторинг) часто имеют высокую задержку и низкую точность. ИИ-решение позволяет:
- Обнаруживать огонь и дым в **реальном времени** (23.82 FPS).
- Работать в сложных условиях (темнота, задымление, мелкие объекты).
- Снизить количество ложных срабатываний.

---

## Основные этапы
0. Изучение существующих кейсов, статей и подходов, их краткий обзор.

1. Подготовка данных:
   - Данные были представлены в формате COCO и преобразованы в формат YOLO.
   - Классы: fire (огонь) и smoke (дым).

2. Обучение модели:
   - Использована предобученная модель YOLOv8m.
   - Начальные гиперпараметры: batch=16, imgsz=640, epochs=20, аугментации (мозаика, mixup, горизонтальное отражение).
   - Метрики после первого этапа обучения (20 эпох):
     - mAP50 (огонь): 0.598, precision: 0.63, recall: 0.535.
     - mAP50 (дым): 0.501, precision: 0.688, recall: 0.363.

3. Дообучение и тонкая настройка гиперпараметров:
   - Уменьшен batch до 8, снижен learning rate до 0.0001, добавлена L2-регуляризация.
   -  Метрики после дообучения (20 эпох):
     - mAP50 (огонь): 0.62, precision: 0.581, recall: 0.576.
     - mAP50 (дым): 0.513, precision: 0.655, recall: 0.362.

4. Визуализация и оценка качества детекции
   - Построены графики потерь для анализа обучения.
   - Проведена визуальная оценка предсказаний: модель хорошо детектирует огонь, но хуже справляется с дымом, особенно слабым или размытым.

5.  Тестирование производительности
   - Среднее время обработки: 0.042 сек на изображение (23.82 FPS), что подходит для реального применения.

---

## Подробнее
[Открыть проект в Google Colab](https://colab.research.google.com/drive/1noHIYxOvLQi2qdfT8GcLqubjig4SYqWD?usp=sharing)
[Jupyter Notebook](fire-and-smoke-detection-with-YOLOv8m.ipynb)
[Обзор статей](articles-and-cases-review.xlsx)

---

## Используемые технологии
- **Python** (основной язык разработки)
- **YOLOv8** (фреймворк для детекции объектов)
- **Google Colab** (среда для обучения модели)
- **OpenCV** (обработка изображений и видео)
- **PyTorch** (библиотека для глубокого обучения)
- **Matplotlib/Seaborn** (визуализация метрик)
- **Roboflow** (подготовка датасета в формате COCO/YOLO)

---

## Основные итоги
### Результаты обучения:
- **Огонь**:
  - mAP50: **0.616**
  - Precision: **0.581**
  - Recall: **0.576**
- **Дым**:
  - mAP50: **0.505**
  - Precision: **0.655**
  - Recall: **0.362**
- **Скорость**: **23.82 FPS** (0.042 сек на кадр).

### Проблемы и пути улучшения:
- Низкий recall для дыма (пропуск объектов).
- **Решения**:
  - Увеличение размера изображения (`imgsz=1024`).
  - Расширение датасета сложными примерами (полупрозрачный дым, мелкие очаги).
  - Использование архитектур с модулями внимания (YOLO + Transformer).

---

## Установка
**Клонирование репозитория и запуск:**
```bash
git clone https://github.com/iv-galkin/fire-smokeYOLO
